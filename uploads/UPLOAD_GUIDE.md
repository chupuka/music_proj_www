# Руководство по работе с файлами

## Структура папок

```
uploads/
├── tracks/              # Аудио файлы
│   ├── 1/              # ID трека
│   │   └── track.mp3
│   ├── 2/
│   │   └── track.mp3
│   └── ...
├── artwork/             # Обложки и изображения
│   ├── albums/         # Обложки альбомов
│   │   ├── 1.jpg
│   │   └── ...
│   └── artists/        # Фото артистов
│       ├── 1.jpg
│       └── ...
└── README.md
```

## Использование

### Хранение треков

**Формат пути:**
```
uploads/tracks/{track_id}/track.{extension}
```

**Примеры:**
- `uploads/tracks/1/track.mp3`
- `uploads/tracks/2/track.flac`
- `uploads/tracks/3/track.wav`

**В базе данных:**
```sql
UPDATE tracks SET file_path = 'uploads/tracks/1/track.mp3' WHERE id = 1;
```

### Хранение обложек

**Альбомы:**
```
uploads/artwork/albums/{album_id}.{extension}
```

**Примеры:**
- `uploads/artwork/albums/1.jpg`
- `uploads/artwork/albums/2.png`

**Артисты:**
```
uploads/artwork/artists/{artist_id}.{extension}
```

**Примеры:**
- `uploads/artwork/artists/1.jpg`
- `uploads/artwork/artists/2.png`

## Поддерживаемые форматы

### Аудио файлы
- MP3 (рекомендуется)
- WAV
- FLAC
- OGG
- M4A

### Изображения
- JPG / JPEG (рекомендуется)
- PNG
- WebP

## Рекомендуемые размеры

### Аудио файлы
- **MP3:** 3-10 MB (качество 128-320 kbps)
- **FLAC:** 20-50 MB (без потерь)
- **WAV:** 30-60 MB (без сжатия)

### Изображения
- **Обложки альбомов:** 1000x1000 пикселей, до 2 MB
- **Фото артистов:** 800x800 пикселей, до 1 MB
- Формат: JPG (для меньшего размера) или PNG (для прозрачности)

## Добавление файлов

### Через админ-панель (в будущем)
1. Создайте трек в админ-панели
2. Загрузите файл через форму загрузки
3. Файл автоматически сохранится в правильную папку

### Вручную
1. Поместите файл в нужную папку:
   ```
   uploads/tracks/1/track.mp3
   ```
2. Обновите путь в БД через админ-панель или SQL:
   ```sql
   UPDATE tracks SET file_path = 'uploads/tracks/1/track.mp3' WHERE id = 1;
   ```

## Доступ к файлам

Файлы будут доступны через:
- Прямой доступ к файловой системе (для локальной разработки)
- HTTP endpoint (когда будет реализован FileController)
- Статический сервер (Nginx, Apache)

## Безопасность

⚠️ **Важно:**
- Проверяйте тип файла перед сохранением
- Ограничивайте размер файлов (максимум 50 MB)
- Валидируйте имена файлов
- Используйте уникальные имена (ID трека в пути)

## Резервное копирование

Папка `uploads/` должна быть включена в систему резервного копирования:
- Регулярно создавайте бэкапы
- Храните копии в отдельном месте
- Тестируйте восстановление

## Миграция

При необходимости можно легко мигрировать на объектное хранилище:
- Обновите пути в БД
- Перенесите файлы
- Измените код загрузки

